(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{502:function(_,v,e){"use strict";e.r(v);var t=e(19),o=Object(t.a)({},(function(){var _=this,v=_.$createElement,e=_._self._c||v;return e("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[e("h2",{attrs:{id:"_1-为什么要打印日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么要打印日志"}},[_._v("#")]),_._v(" 1. 为什么要打印日志")]),_._v(" "),e("p",[_._v("在后端开发中，日志的打印具有重要的意义，当系统在线下调试时，能够详细输出过程参数，以及上线后，系统出问题时，能够有记录可查看。")]),_._v(" "),e("h2",{attrs:{id:"_2-日志级别的种类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-日志级别的种类"}},[_._v("#")]),_._v(" 2. 日志级别的种类")]),_._v(" "),e("p",[_._v("日志级别种类总共为 4 类，如下所示（不允许再添加其他级别的日志，比如：trace）：")]),_._v(" "),e("blockquote",[e("p",[e("code",[_._v("ERROR")]),_._v(" > "),e("code",[_._v("WARN")]),_._v(" >  "),e("code",[_._v("INFO")]),_._v(" >  "),e("code",[_._v("DEBUG")]),_._v("\n日志级别依次递减。")])]),_._v(" "),e("h2",{attrs:{id:"_3-各种日志级别的使用场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-各种日志级别的使用场景"}},[_._v("#")]),_._v(" 3.  各种日志级别的使用场景")]),_._v(" "),e("ul",[e("li",[e("p",[e("code",[_._v("ERROR")]),_._v(" 日志级别使用场景（"),e("strong",[_._v("本质：")]),_._v(" "),e("mark",[_._v("系统出现严重错误、或者未知的错误，需要马上处理!!!")]),_._v(" ）")]),_._v(" "),e("ul",[e("li",[_._v("所有的异常相关的日志，都应该用 "),e("code",[_._v("ERROR")]),_._v("  级别日志来打印，除非后面，这类日志觉得不重要，可以降级为 "),e("code",[_._v("WARN")]),_._v(" 级别。")]),_._v(" "),e("li",[_._v("如果代码中确定某种流程或者分支一定不会出现，也可以打印为"),e("code",[_._v("ERROR")]),_._v("级别的日志（特别是在 if/else 分支的场景）。")])])]),_._v(" "),e("li",[e("p",[e("code",[_._v("WARN")]),_._v(" 日志级别使用场景（"),e("strong",[_._v("本质：")]),_._v(" "),e("mark",[_._v("系统出现问题，但是不足以影响主流程，可在当天内处理掉!!！")]),_._v("）")]),_._v(" "),e("ul",[e("li",[_._v("参数校验异常一般用 "),e("code",[_._v("WARN")]),_._v("  级别打印日志。")]),_._v(" "),e("li",[_._v("重试时，打印中间的状态过程，使用 "),e("code",[_._v("WARN")]),_._v(" 级别日志。")]),_._v(" "),e("li",[_._v("某些场景（不影响主流程） "),e("code",[_._v("ERROR")]),_._v(" 级别日志降级为 "),e("code",[_._v("WARN")])])])]),_._v(" "),e("li",[e("p",[e("code",[_._v("INFO")]),_._v(" 日志级别使用场景（"),e("strong",[_._v("本质：")]),_._v(" "),e("mark",[_._v("记录状态的日志，用于了解系统的运行情况!!!")]),_._v("）")]),_._v(" "),e("ul",[e("li",[_._v("定时任务运行时，开始和结束的打印日志使用 "),e("code",[_._v("INFO")]),_._v(" 级别日志。")]),_._v(" "),e("li",[_._v("项目启动成功时，一些参数的打印使用 "),e("code",[_._v("INFO")]),_._v(" 级别日志。")]),_._v(" "),e("li",[_._v("apollo配置的变更，使用 "),e("code",[_._v("INFO")]),_._v(" 级别日志，记录状态的变更。")]),_._v(" "),e("li",[_._v("初始化任务，使用  "),e("code",[_._v("INFO")]),_._v(" 级别日志，就初始化日志的开始和结束时间")]),_._v(" "),e("li",[_._v("慢日志的打印，使用 "),e("code",[_._v("INFO")]),_._v(" 级别打印。")])])]),_._v(" "),e("li",[e("p",[e("code",[_._v("DEBUG")]),_._v(" 日志级别使用场景（"),e("strong",[_._v("本质")]),_._v("： "),e("mark",[_._v("用户线下环境进行调试时的中间过程打印，线上一般不开启!!!")]),_._v("）")]),_._v(" "),e("ul",[e("li",[_._v("线下环境的入参以及返回值的打印。")])])])]),_._v(" "),e("h2",{attrs:{id:"_4-不同环境使用级别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-不同环境使用级别"}},[_._v("#")]),_._v(" 4. 不同环境使用级别")]),_._v(" "),e("ul",[e("li",[_._v("线下环境使用（最低级别 "),e("code",[_._v("DEBUG")]),_._v("）："),e("code",[_._v("ERROR")]),_._v(" > "),e("code",[_._v("WARN")]),_._v(" >  "),e("code",[_._v("INFO")]),_._v(" >  "),e("code",[_._v("DEBUG")])]),_._v(" "),e("li",[_._v("线上环境使用（最低级别 "),e("code",[_._v("INFO")]),_._v("）："),e("code",[_._v("ERROR")]),_._v(" > "),e("code",[_._v("WARN")]),_._v(" >  "),e("code",[_._v("INFO")])])]),_._v(" "),e("h2",{attrs:{id:"_5-线上日志如何监控"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-线上日志如何监控"}},[_._v("#")]),_._v(" 5. 线上日志如何监控")]),_._v(" "),e("p",[_._v("线上的日志级别监控分为两大类：")]),_._v(" "),e("ol",[e("li",[e("code",[_._v("ERROR")]),_._v(" 日志监控告警，告警发送到企业微信小组群。")]),_._v(" "),e("li",[e("code",[_._v("WARN")]),_._v("  日志监控告警，告警发送到企业微信小组群。")])]),_._v(" "),e("h2",{attrs:{id:"_6-持续的日志优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-持续的日志优化"}},[_._v("#")]),_._v(" 6. 持续的日志优化")]),_._v(" "),e("p",[_._v("【重要】\n打印日志好比写一篇文章，不可能一开始就把一篇文章写好。一份高效、质量高的日志，需要大家持续的优化。比如：好的日志能够在出问题的时候，清楚的知道什么人在什么时间做了什么事，以及出错的时候能够串联尽可能的上下文信息（即4H+1W）。")]),_._v(" "),e("p",[e("strong",[_._v("实践准则：")])]),_._v(" "),e("ol",[e("li",[_._v("遵循上面的日志级别输出准则")]),_._v(" "),e("li",[_._v("开发的时候要时刻反复推销线上可能出现的问题，出问题时，我的日志是否能够清晰的反应当时的问题")]),_._v(" "),e("li",[_._v("至少要在线上的环境，完整的看下自己打印的日志是否合理，是否有效")]),_._v(" "),e("li",[_._v("上线后，观察线上的日志是否该打的都打了，不该打的没有打，如果有不合理的地方，即时发版更新下（修改和添加日志不会影响业务功能），在之后发现不合理的时候，可以单独发掉或者跟着新的需求一起发布掉")]),_._v(" "),e("li",[_._v("线上的 "),e("code",[_._v("ERROR")]),_._v(" 级别日志要达到分钟级或者至少小时级别处理")]),_._v(" "),e("li",[_._v("线上的 "),e("code",[_._v("WARN")]),_._v(" 级别日志要在天级别内处理掉")]),_._v(" "),e("li",[_._v("持续的关注线上的日志是否合理，罗马不是一天建成的")])]),_._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[_._v("小技巧")]),_._v(" "),e("p",[e("strong",[_._v("如何让日志在控制台打印的更优雅？")])]),_._v(" "),e("p",[_._v('\'%d{yyyy-MM-dd HH:mm:ss.SSS}  %highlight(%-5level) ${PID} %X{traceId} --- "%thread" "%F:%L" "%cyan(%logger{50})" : "%msg"##%n\'')])])])}),[],!1,null,null,null);v.default=o.exports}}]);